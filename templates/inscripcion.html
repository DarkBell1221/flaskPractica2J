<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Cursos</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://js.pusher.com/7.0/pusher.min.js"></script>
</head>
<body>
    <h1>Registro de Cursos</h1>
    <form id="cursoForm">
        <label for="nombre">Nombre del Curso:</label>
        <input type="text" id="nombre" name="Nombre">
        <br>
        <label for="telefono">Teléfono:</label>
        <input type="text" id="telefono" name="Telefono">
        <br>
        <button type="submit">Registrar Curso</button>
    </form>

    <h2>Lista de Cursos Registrados</h2>
    <ul id="cursosList"></ul>

    <script>
        $(document).ready(function () {
            // Enviar datos del formulario con AJAX
            $('#cursoForm').on('submit', function (e) {
                e.preventDefault();
                
                $.ajax({
                    type: 'POST',
                    url: '/registrar',
                    data: $(this).serialize(),
                    success: function (response) {
                        alert('Curso registrado con éxito');
                        $('#cursoForm')[0].reset();  // Limpiar el formulario
                    },
                    error: function (response) {
                        alert('Error al registrar el curso');
                    }
                });
            });

            // Configurar Pusher para recibir actualizaciones en tiempo real
            const pusher = new Pusher('e1d8c501f1496bf4614e', {
                cluster: 'us2'
            });

            const channel = pusher.subscribe('cursos-channel');
            channel.bind('curso-registrado', function (data) {
                const nuevoCurso = `<li>Curso: ${data.Nombre_Curso} - Teléfono: ${data.Telefono}</li>`;
                $('#cursosList').append(nuevoCurso);  // Agregar el nuevo curso a la lista
            });
        });
    </script>
</body>
</html>
