<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registros</title>
    <script src="https://js.pusher.com/7.2/pusher.min.js"></script>
</head>
<body>

<h1>Lista de Cursos</h1>
<div id="registros-container">
    {% if registros %}
        {% for registro in registros %}
        <div id="registro-{{ registro['Id_Cursos'] }}">
            <p>Nombre del Curso: {{ registro['Nombre_Curso'] }}</p>
            <p>Teléfono: {{ registro['Telefono'] }}</p>
            <form action="/editar_registro/{{ registro['Id_Cursos'] }}" method="POST">
                <input type="text" name="nombre_curso" value="{{ registro['Nombre_Curso'] }}">
                <input type="text" name="telefono" value="{{ registro['Telefono'] }}">
                <button type="submit">Guardar cambios</button>
            </form>
            <form action="/eliminar/{{ registro['Telefono'] }}" method="POST">
                <button type="submit">Eliminar</button>
            </form>
        </div>
        {% endfor %}
    {% else %}
        <p>No hay registros disponibles.</p>
    {% endif %}
</div>

<script>
  // Configuración de Pusher
  var pusher = new Pusher('e1d8c501f1496bf4614e', {
    cluster: 'us2'
  });

  var channel = pusher.subscribe('registros');

  // Escucha cuando se agregue un nuevo registro
  channel.bind('nuevo', function(data) {
    alert("Nuevo registro añadido: " + data.nombre_curso + ", " + data.telefono);
    // Actualiza la interfaz con el nuevo curso (puedes usar código para añadir dinámicamente)
  });

  // Escucha cuando se edite un registro
  channel.bind('editar', function(data) {
    alert("Registro actualizado: " + data.nombre_curso + ", " + data.telefono);
    // Actualiza la interfaz con los datos editados
  });

  // Escucha cuando se elimine un registro
  channel.bind('eliminar', function(data) {
    alert("Registro eliminado con teléfono: " + data.telefono);
    // Remueve el registro eliminado de la interfaz
  });
</script>

</body>
</html>
